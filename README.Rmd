---
title: "Estimation of Behavioral Entropy Rate : R-Software"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# $\texttt{ccber}$: an `R` Package for the Estimation of Behavioral Entropy Rate - Developed for the Conte Center @ UCI

See reference: _Early Life Exposure to Unpredictable Maternal Sensory Signals Influences Cognitive Development: A Cross-Species Approach_ Elysia Davis, Stephanie Stour, Jenny Molet, Brian Vegetabile, Laura Glynn, Curt Sandman, Kevin Heins, Hal Stern, and Tallie Baram: To appear in the Proceedings of the National Academy of Sciences

## Installing `ccber`

The package `devtools` is required to install this `R` package from this Github repository.  Install this package first if it is not already installed.

```{r, echo=TRUE, eval=FALSE}
install.packages('devtools', dependencies = TRUE)
```

Once that package has been installed, use the following to install `ccber`

```{r, echo=TRUE, eval=FALSE}
devtools::install_github('bvegetabile/ccber')
```

Load the package to begin analysis!

```{r, echo=TRUE, eval=TRUE}
library('ccber')
```

## Using `ccber` with Observer Files

## 

## A Longer Example of How to Estimate Entropy Rate using `ccber`

Consider the following transition matrix of a first-order Markov chain with three states,

```{r, echo=TRUE, eval=TRUE}
P = matrix(c(0.2, 0.3, 0.5, 
             0.7, 0.1, 0.2,
             0.2, 0.2, 0.6), 3,3, byrow = T)
```

We can simulate from a Markov process with this using the function `SimulateMarkovChain`

```{r, echo=T, eval=T}
mc_chain <- SimulateMarkovChain(trans_mat = P, n_sims = 5000)
head(mc_chain, n = 20)
```

From this we can calculate a matrix of transition counts 

```{r, echo=T, eval=T}
tc <- CalcTransitionCounts(mc_chain)
tc
```

And then estimate a transition matrix,

```{r, echo=T, eval=T}
tm <- CalcTransitionMatrix(tc)
tm
```

which agrees fairly well with the true `P`.  Additionally we can estimate the stationary distribution of the process in a one of two ways.  The first way is an empirical estimate from the observed sequence.  

```{r, echo=T, eval=T}
emp_sm <- CalcEmpiricalStationary(mc_chain, state_space = 1:3)
emp_sm
```

The second way is an eigendecomposition of the observed transition matrix, though the preferred method is through the empirical estimation procedure.

```{r, echo=T, eval=T}
eig_sm <- CalcEigenStationary(tm)
eig_sm
```

Using both the stationary distribution estimate and the estimate of the transition matrix, the entropy rate of the process can be estimated using the following commands

```{r, echo=T, eval=T}
entrate1 <- CalcMarkovEntropyRate(tm, emp_sm)
entrate1
```

```{r, echo=T, eval=T}
entrate2 <- CalcMarkovEntropyRate(tm, eig_sm)
entrate2
```

Both of these values agree very well with the true entropy rate,
```{r, echo=T, eval=T}
true_entropy_rate <- CalcMarkovEntropyRate(P, CalcEigenStationary(P))
true_entropy_rate
```


## A Shorter Example

If the method of estimation for the stationary distrbution is known, a more simple function is provided to estimate the entropy rate as well.

Both of these values agree very well with the true entropy rate,
```{r, echo=T, eval=T}
quicker_estimate <- CalcEntropyRate(mc_chain, 
                                    state_space = 1:3, 
                                    stat_method = "Empirical")
quicker_estimate
```

